% \usefonttheme{serif}
% \geometry{paperwidth=140mm,paperheight=105mm}

\usepackage[no-math]{fontspec}
% \setmainfont{texgyretermes}[
%   UprightFont = *-regular ,
%   BoldFont = *-bold ,
%   ItalicFont = *-italic ,
%   BoldItalicFont = *-bolditalic ,
%   Extension = .otf ,
%   Scale = 1.0]
  
% \setsansfont{texgyreheros}[
%   UprightFont = *-regular ,
%   BoldFont = *-bold ,
%   ItalicFont = *-italic ,
%   BoldItalicFont = *-bolditalic ,
%   Extension = .otf ,
%   Scale = 0.9]

% \setmonofont{cmun}[
%   UprightFont = *tt ,
%   BoldFont    = *tb ,
%   ItalicFont  = *it ,
%   BoldItalicFont = *tx,
%   Extension   = .otf ,
% ]
\RequirePackage[UTF8,scheme=plain,fontset=none]{ctex}
\usepackage{xeCJKfntef}
\setCJKmainfont[BoldFont={FZHei-B01},ItalicFont={FZKai-Z03}]{FZShuSong-Z01}
\setCJKsansfont[BoldFont={FZHei-B01}]{FZKai-Z03}
\setCJKmonofont[BoldFont={FZHei-B01}]{FZFangSong-Z02}
\setCJKfamilyfont{zhsong}{FZShuSong-Z01}
\setCJKfamilyfont{zhhei}{FZHei-B01}
\setCJKfamilyfont{zhkai}[BoldFont={FZHei-B01}]{FZKai-Z03}
\setCJKfamilyfont{zhfs}[BoldFont={FZHei-B01}]{FZFangSong-Z02}
\newcommand*{\songti}{\CJKfamily{zhsong}}
\newcommand*{\heiti}{\CJKfamily{zhhei}}
\newcommand*{\kaishu}{\CJKfamily{zhkai}}
\newcommand*{\fangsong}{\CJKfamily{zhfs}}
\renewcommand{\emph}{\CJKunderline}

\usepackage{anyfontsize}
\usepackage[english]{babel}
\usepackage{scrextend}
\addtokomafont{labelinglabel}{\normalfont\bfseries}
\usepackage{amsmath,amssymb}
\usepackage{bookmark}

\usetheme[sectionpage=none]{metropolis}
\setlength\abovecaptionskip{-1pt}
\setlength\belowcaptionskip{-1pt}
% adjust the space between caption and figure and table
% source: https://tex.stackexchange.com/questions/197879/how-to-adjust-spacing-between-caption-and-table-figure-in-beamer
\usefonttheme{professionalfonts}
\titlegraphic{\includegraphics[width=1cm]{logo.png}}


\setbeamerfont{normal text}{family=\kaishu\sffamily}
\setbeamerfont{frametitle}{family=\large\bfseries\sffamily}
\setbeamerfont{title}{family=\bfseries}
\setbeamerfont{subtitle}{family=\kaishu}
\setbeamerfont{institute}{size=\small}
\definecolor{iron}{RGB}{0,82,67}
\setbeamercolor{frametitle}{bg=iron}
\setbeamercolor{progress bar}{fg=iron,bg=iron}


\setbeamertemplate{section in toc}[ball unnumbered]
\setbeamerfont{section in toc}{family=\heiti\sffamily}
\setbeamerfont{myTOC}{}
\AtBeginSection[]{\frame{\frametitle{目录}%
                  \usebeamerfont{myTOC}\tableofcontents[currentsection, hideallsubsections]}}

\setcounter{tocdepth}{4}
\makeatletter
\setbeamertemplate{frametitle}[default][left,leftskip=\the\dimexpr\beamer@leftmargin-0.6cm\relax]
\makeatother


\setbeamertemplate{footline}
{%
   \leavevmode%
 \hskip1cm \fangsong \insertshortauthor \quad|\quad \insertshorttitle \hfill \normalfont  \insertframenumber\,/\,\inserttotalframenumber  \hskip1cm \hfill
   \vskip6pt%
}

\graphicspath{{image/}{figure/}{fig/}{img/}}
\usepackage{booktabs}
\usepackage{silence}
\WarningFilter{latexfont}{Font shape}
\let\scshape\relax
\usepackage{type1cm}
\AtBeginDocument{\usebeamerfont{normal text}}

\newcommand\email[1]{\href{mailto:#1}{\nolinkurl{#1}}}

\renewcommand\ttdefault{lmtt}

\usepackage[]{listings}
\usepackage{MnSymbol}
\usepackage[]{ninecolors}
\lstset{
  basicstyle  = \small\ttfamily,
  breaklines,
  % breakatwhitespace,
  prebreak    = {\mbox{$ \rhookswarrow $}},
  postbreak   = {\mbox{$ \lhookrightarrow $\quad}},
  breakindent = 10pt,
}
\lstdefinelanguage{cmd}{
  morekeywords  = [1]
    {
      tlmgr, pdflatex, latexmk, xelatex, cd, dir, mkdir, 
      ls, del, rm, mv, move, cp, copy, code, bibtex, biber,
      texdoc, kpsewhich, texhash
    },
  morekeywords  = [2]{action, info, option, update, install, remove, version, restore},
  keywordstyle  = [1]{\bfseries},
  keywordstyle  = [2]{\color{azure4}},
  moredelim     = [s][\color{green5}]{-}{\ },
  morecomment   = [l][\color{gray6}\itshape]{\#},
  numbers     = left,
  numberstyle = \tiny\ttfamily,
}
\lstdefinelanguage{mylatex}{
  language={[LaTeX]TeX},
  texcsstyle  =*\color{azure4}\bfseries,
  keywordstyle=\color{green5}\bfseries,
  morekeywords={document},
  morecomment = [l][\color{gray6}\itshape]{\%},
  moretexcs   =
    {
      usepackage, documentclass, LaTeX, LaTex, label, ref, tableofcontents, begin, end, bibliography, bibliographystyle, cite, NeedsTeXFormat, ProvidesPackage, newcommand, mycmd
    }
}
\lstdefinestyle{output}{
  basicstyle=\tiny\ttfamily, frame=single,
}

\lstnewenvironment{cmdcode}{\lstset{language=cmd, frame=single}}{}

\lstnewenvironment{latexcode}{\lstset{language=mylatex, frame=single}}{}

\lstnewenvironment{outputcode}{\lstset{style=output}}{}

\NewDocumentCommand \cmd { } {\lstinline[language=cmd]}

\NewDocumentCommand \lcmd { } {\lstinline[language=mylatex]}

\NewDocumentCommand \frameaction { } 
  { \texttt }

\NewDocumentCommand \pkg { } { \lstinline }
% \newcommand{\lcmd}{\lstinline[language=mylatex]}

\NewDocumentCommand \tlmgr { } { \texttt{tlmgr} }

\usepackage[os=win]{menukeys}
\usepackage{fontawesome5}

\NewDocumentCommand \win { } { \faWindows }
\NewDocumentCommand \texlive { } { \TeX{} Live }

\AtEndPreamble{
  % \usepackage{hyperref}
  \hypersetup{colorlinks=true, linkcolor=mDarkTeal}
  }